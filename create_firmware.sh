#!/bin/sh -x

MKSQUASHFS="netgear-r6200-mksquashfs" 
MKSQUASHFS_OPTS="-noappend -all-root"
FW_CODE_DIR="/home/zach/code/wifi-reversing/netgear/r6200/firmware_building"
ROOTFS=$1
KERNEL=$2
OUTPUT_FILE=$3

TRX_FW="$1.bin"

$MKSQUASHFS "$ROOTFS" "$TRX_FW" $MKSQUASHFS_OPTS

"$FW_CODE_DIR"/firmware_generator.py "$KERNEL" "$TRX_FW" "$OUTPUT_FILE"
